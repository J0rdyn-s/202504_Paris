# Set the start and end dates
$startDate = Get-Date "2025-04-11"
$endDate = Get-Date "2025-04-21"

# Sample event (ordered)
$scheduleItem = [ordered]@{
    type      = "schedule"
    start     = "0900"
    end       = "1000"
    event_kr  = "ì˜ˆì‹œ ì¼ì •ì…ë‹ˆë‹¤"
    note_kr   = "ì´ê³³ì— í•œêµ­ì–´ ë©”ëª¨ë¥¼ ì‘ì„±í•˜ì„¸ìš”"
    event_en  = "Sample event"
    note_en   = "Write your note here"
    ticket    = $null
    map       = $null
    more      = "https://example.com/more-info"
}

# Sample info block between events (ordered)
$infoItem = [ordered]@{
    type      = "info"
    start     = "1000"
    end       = "1030"
    event_kr  = "ğŸš¶ ë‹¤ìŒ ì¥ì†Œë¡œ ì´ë™"
    note_kr   = "15ë¶„ ì˜ˆìƒ"
    event_en  = "Walk to the next place"
    note_en   = "Estimated 15 minutes"
    ticket    = $null
    map       = "https://maps.google.com"
    more      = $null
}

# Generate a file for each date
while ($startDate -le $endDate) {
    $dateFormatted = $startDate.ToString("yyyyMMdd")
    $filename = "${dateFormatted}_Schedule.json"

    $schedule = @(
        $scheduleItem
        $infoItem
        $scheduleItem
    )

    $schedule | ConvertTo-Json -Depth 4 | Out-File -Encoding UTF8 -FilePath $filename

    Write-Host "Created $filename"

    $startDate = $startDate.AddDays(1)
}
